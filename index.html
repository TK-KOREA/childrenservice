<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì•ˆì–‘êµíšŒ ìœ ì´ˆë“±ë¶€ ì¼ì • ì•ˆë‚´</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700;900&display=swap" rel="stylesheet">
    <style>
        :root {
            /* ê¸°ë³¸(ë³´í†µ) ì‚¬ì´ì¦ˆ ë³€ìˆ˜ */
            --day-min-height-mobile: 75px;
            --day-min-height-tablet: 85px;
            --day-min-height-pc: 140px;
            --date-font-size: 0.875rem; /* 14px */
            --event-font-size: 8px;
            --event-font-size-pc: 10px;
        }

        /* ì‘ê²Œ ì˜µì…˜ */
        .zoom-small {
            --day-min-height-mobile: 60px;
            --day-min-height-tablet: 70px;
            --day-min-height-pc: 110px;
            --date-font-size: 0.75rem;
            --event-font-size: 7px;
            --event-font-size-pc: 9px;
        }

        /* í¬ê²Œ ì˜µì…˜ */
        .zoom-large {
            --day-min-height-mobile: 90px;
            --day-min-height-tablet: 105px;
            --day-min-height-pc: 180px;
            --date-font-size: 1.125rem;
            --event-font-size: 10px;
            --event-font-size-pc: 13px;
        }

        body { 
            font-family: 'Noto Sans KR', sans-serif; 
            background-color: #fdfcf8; 
            scroll-behavior: smooth;
            font-size: 14px;
            transition: font-size 0.2s ease;
        }
        @media (min-width: 768px) {
            body { font-size: 16px; }
        }
        
        .calendar-day { 
            min-height: var(--day-min-height-tablet); 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            justify-content: flex-start; 
            padding: 0.2rem 0.1rem; 
            border-radius: 0.4rem; 
            position: relative; 
            transition: all 0.2s ease-in-out; 
            border: 1px solid #f1f5f9; 
            background: white; 
            overflow: hidden; 
        }

        @media (max-width: 767px) {
            .calendar-day { 
                min-height: var(--day-min-height-mobile); 
                padding: 0.15rem 0.05rem;
                border-radius: 0.25rem;
            }
        }

        @media (min-width: 1024px) { 
            .calendar-day { 
                min-height: var(--day-min-height-pc); 
                padding: 0.5rem 0.25rem; 
                border-radius: 0.75rem; 
            } 
        }

        .calendar-day:hover { 
            background-color: #fffaf5; 
            z-index: 10; 
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05); 
            transform: translateY(-2px);
        }

        /* ë‚ ì§œ ìˆ«ì í¬ê¸° ì¡°ì ˆ */
        .date-label {
            font-size: var(--date-font-size);
            font-weight: 900;
        }
        
        .event-bar { 
            font-size: var(--event-font-size); 
            padding: 1px 2px; 
            border-radius: 2px; 
            margin-top: 1px; 
            width: 96%; 
            overflow: hidden; 
            text-overflow: ellipsis; 
            white-space: nowrap; 
            font-weight: 700; 
            cursor: pointer; 
            text-align: left; 
            border-width: 1px;
            line-height: 1.1;
        }

        @media (min-width: 768px) { 
            .event-bar { 
                font-size: var(--event-font-size-pc); 
                padding: 2px 4px; 
                border-radius: 4px; 
                margin-top: 2px;
                line-height: 1.2;
                border-width: 1.5px;
            } 
        }
        
        .loader { border: 3px solid #f3f3f3; border-top: 3px solid #fb923c; border-radius: 50%; width: 28px; height: 28px; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        
        .section-card { background: white; border-radius: 1.25rem; box-shadow: 0 10px 30px -10px rgba(0,0,0,0.04); border: 1px solid #f1f5f9; overflow: hidden; }
        @media (min-width: 768px) {
            .section-card { border-radius: 2rem; }
        }

        .kids-gradient { background: linear-gradient(135deg, #fb923c 0%, #facc15 100%); }
        .keep-all { word-break: keep-all; }

        /* ì‚¬ì´ì¦ˆ ì¡°ì ˆ ë²„íŠ¼ í™œì„±í™” ìƒíƒœ */
        .size-btn-active {
            background-color: #fb923c;
            color: white;
            border-color: #fb923c;
        }
    </style>
</head>
<body class="text-slate-800">

    <!-- ë¡œë”© í™”ë©´ -->
    <div id="loadingOverlay" class="fixed inset-0 bg-white/95 backdrop-blur-md z-50 flex flex-col items-center justify-center transition-opacity duration-500">
        <div class="loader mb-4"></div>
        <p class="text-orange-600 font-bold tracking-tight text-sm md:text-base">ìœ ì´ˆë“±ë¶€ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤...</p>
    </div>

    <!-- ë„¤ë¹„ê²Œì´ì…˜ -->
    <nav class="sticky top-0 z-40 bg-white/80 backdrop-blur-md border-b border-orange-100">
        <div class="max-w-6xl mx-auto px-4 md:px-6 h-14 md:h-16 flex items-center justify-between">
            <div class="flex items-center gap-2 md:gap-3">
                <div class="w-7 h-7 md:w-8 md:h-8 kids-gradient rounded-lg flex items-center justify-center text-white font-black shadow-sm text-sm md:text-base">ê¿ˆ</div>
                <span class="font-black text-base md:text-xl tracking-tight text-slate-800">ì•ˆì–‘êµíšŒ ìœ ì´ˆë“±ë¶€</span>
            </div>
            
            <!-- ì‚¬ì´ì¦ˆ ì¡°ì ˆ ì»¨íŠ¸ë¡¤ëŸ¬ -->
            <div class="flex items-center bg-slate-100 p-1 rounded-lg border border-slate-200">
                <button onclick="changeSize('small')" id="btn-small" class="px-2 md:px-3 py-1 text-[10px] md:text-xs font-bold rounded-md transition-all text-slate-500 hover:bg-white">ì‘ê²Œ</button>
                <button onclick="changeSize('normal')" id="btn-normal" class="px-2 md:px-3 py-1 text-[10px] md:text-xs font-bold rounded-md transition-all size-btn-active">ë³´í†µ</button>
                <button onclick="changeSize('large')" id="btn-large" class="px-2 md:px-3 py-1 text-[10px] md:text-xs font-bold rounded-md transition-all text-slate-500 hover:bg-white">í¬ê²Œ</button>
            </div>
        </div>
    </nav>

    <!-- íˆì–´ë¡œ ì„¹ì…˜ -->
    <header class="max-w-6xl mx-auto px-4 md:px-6 pt-6 md:pt-10 pb-2 md:pb-6 text-center">
        <h1 class="text-2xl md:text-5xl font-black text-slate-900 mb-1 md:mb-3 leading-tight keep-all">
            ìš°ë¦¬ë“¤ì˜ <span class="text-orange-500">ì¦ê±°ìš´ ì•½ì†</span>
        </h1>
        <p class="text-slate-500 text-[11px] md:text-base opacity-80 keep-all">í•¨ê»˜ ëª¨ì—¬ ì˜ˆë°°í•˜ê³  í™œë™í•˜ëŠ” ì†Œì¤‘í•œ ì‹œê°„ë“¤ì„ í™•ì¸í•˜ì„¸ìš”.</p>
    </header>

    <main class="max-w-7xl mx-auto px-2 md:px-6 pb-16">
        <section id="schedule" class="mt-2 md:mt-4">
            <div class="section-card p-2 md:p-8 lg:p-10">
                <!-- ë‹¬ë ¥ ì»¨íŠ¸ë¡¤ëŸ¬ -->
                <div class="flex justify-between items-center mb-4 md:mb-8 px-1">
                    <button id="prevMonth" class="p-2 md:p-3 text-slate-400 hover:text-orange-500 rounded-full hover:bg-orange-50 active:scale-90 transition-all">
                        <svg class="w-5 h-5 md:w-6 md:h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M15 19l-7-7 7-7"></path></svg>
                    </button>
                    
                    <div class="flex flex-col items-center">
                        <div class="flex items-center gap-2 md:gap-4">
                            <h3 id="calendarTitle" class="text-lg md:text-4xl font-black text-slate-800 tracking-tight">ë¡œë”©ì¤‘...</h3>
                            <button onclick="goToToday()" class="text-[9px] md:text-[11px] font-black text-orange-600 bg-orange-50 hover:bg-orange-100 border border-orange-200 px-2 md:px-3 py-1 rounded-full transition-colors uppercase">Today</button>
                        </div>
                    </div>

                    <button id="nextMonth" class="p-2 md:p-3 text-slate-400 hover:text-orange-500 rounded-full hover:bg-orange-50 active:scale-90 transition-all">
                        <svg class="w-5 h-5 md:w-6 md:h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M9 5l7 7-7 7"></path></svg>
                    </button>
                </div>

                <!-- ìš”ì¼ í—¤ë” -->
                <div class="grid grid-cols-7 gap-1 md:gap-3 text-center mb-1 md:mb-4 border-b border-slate-50 pb-2">
                    <div class="text-red-400 font-black text-[10px] md:text-sm uppercase tracking-tighter sm:tracking-normal">Sun</div>
                    <div class="text-slate-300 font-black text-[10px] md:text-sm uppercase tracking-tighter sm:tracking-normal">Mon</div>
                    <div class="text-slate-300 font-black text-[10px] md:text-sm uppercase tracking-tighter sm:tracking-normal">Tue</div>
                    <div class="text-slate-300 font-black text-[10px] md:text-sm uppercase tracking-tighter sm:tracking-normal">Wed</div>
                    <div class="text-slate-300 font-black text-[10px] md:text-sm uppercase tracking-tighter sm:tracking-normal">Thu</div>
                    <div class="text-slate-300 font-black text-[10px] md:text-sm uppercase tracking-tighter sm:tracking-normal">Fri</div>
                    <div class="text-blue-400 font-black text-[10px] md:text-sm uppercase tracking-tighter sm:tracking-normal">Sat</div>
                </div>

                <!-- ë‹¬ë ¥ ê·¸ë¦¬ë“œ -->
                <div id="calendarGrid" class="grid grid-cols-7 gap-1 md:gap-2 text-center"></div>
            </div>
        </section>
    </main>

    <!-- í‘¸í„° -->
    <footer class="py-12 text-center text-slate-300 text-[10px] md:text-xs font-medium tracking-[0.2em] uppercase px-4 keep-all">
        Â© 2026 ANYANG CHURCH CHILDREN MINISTRY. ALL RIGHTS RESERVED.
    </footer>

    <!-- ìƒì„¸ ì¼ì • ëª¨ë‹¬ -->
    <div id="detailModal" class="hidden fixed inset-0 z-50 overflow-y-auto">
        <div class="fixed inset-0 bg-slate-900/60 backdrop-blur-md transition-opacity" onclick="closeModal()"></div>
        <div class="flex min-h-full items-center justify-center p-4">
            <div class="bg-white rounded-[1.5rem] md:rounded-[2.5rem] shadow-2xl w-full max-w-lg relative overflow-hidden transform transition-all animate-in zoom-in duration-200">
                <button onclick="closeModal()" class="absolute top-4 right-4 md:top-6 md:right-6 text-slate-300 hover:text-slate-800 bg-slate-50 rounded-full p-2 md:p-2.5 transition-colors z-10">
                    <svg class="w-5 h-5 md:w-6 md:h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M6 18L18 6M6 6l12 12"></path></svg>
                </button>
                <div id="modalContent" class="p-6 md:p-12">
                    <!-- ìƒì„¸ ë‚´ìš© ì‚½ì… -->
                </div>
            </div>
        </div>
    </div>

    <script>
        const SHEET_ID = '18zGuXQQWPm_dM2W6xD2Ugysaiz-sukIFJByO_TZrFy0'; 
        let events = []; 
        const todayObj = new Date();
        let currentDate = new Date(todayObj.getFullYear(), todayObj.getMonth(), 1); 
        let currentSize = 'normal';

        // ì‚¬ì´ì¦ˆ ë³€ê²½ í•¨ìˆ˜
        window.changeSize = (size) => {
            currentSize = size;
            document.body.classList.remove('zoom-small', 'zoom-large');
            if (size === 'small') document.body.classList.add('zoom-small');
            if (size === 'large') document.body.classList.add('zoom-large');

            // ë²„íŠ¼ ìƒíƒœ ì—…ë°ì´íŠ¸
            ['small', 'normal', 'large'].forEach(s => {
                const btn = document.getElementById(`btn-${s}`);
                if (s === size) {
                    btn.classList.add('size-btn-active');
                    btn.classList.remove('text-slate-500', 'hover:bg-white');
                } else {
                    btn.classList.remove('size-btn-active');
                    btn.classList.add('text-slate-500', 'hover:bg-white');
                }
            });

            // ë‹¬ë ¥ ë‹¤ì‹œ ê·¸ë¦¬ê¸° (ë ˆì´ì•„ì›ƒ ë³€ë™ ëŒ€ì‘)
            renderCalendar();
        };

        async function fetchGoogleSheetData() {
            try {
                const url = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json&t=${Date.now()}`;
                const res = await fetch(url);
                const text = await res.text();
                const json = JSON.parse(text.substring(text.indexOf('{'), text.lastIndexOf('}') + 1));
                const rows = json.table.rows;
                
                events = rows.map((r, idx) => {
                    const startRaw = r.c[0]?.v;
                    if (!startRaw || r.c[0]?.f === "ì‹œì‘ì¼") return null; 

                    return {
                        id: idx,
                        start: parseGoogleDate(startRaw, r.c[0]?.f),
                        end: parseGoogleDate(r.c[1]?.v, r.c[1]?.f),
                        startTime: formatGoogleTime(r.c[2]?.v),
                        endTime: formatGoogleTime(r.c[3]?.v),
                        meetingType: r.c[4]?.v || "ì†Œê·¸ë£¹",
                        leader: r.c[5]?.v || "-",
                        speaker: r.c[6]?.v || "-",
                        division: r.c[7]?.v || "-",
                        mealPrep: r.c[8]?.v || "-",
                        mealTeam: r.c[9]?.v || "-",
                        menu: r.c[10]?.v || "-",
                        wash: r.c[11]?.v || "-",
                        subject: r.c[12]?.v || "",
                        note: r.c[13]?.v || ""
                    };
                }).filter(e => e !== null);
            } catch (e) { 
                console.error("Data Fetch Error:", e); 
            }
            
            document.getElementById('loadingOverlay').classList.add('hidden');
            renderCalendar();
        }

        function parseGoogleDate(raw, formatted) {
            if (!raw) return null;
            if (typeof raw === 'string' && raw.startsWith('Date')) {
                const m = raw.match(/Date\((\d+),(\d+),(\d+)\)/);
                if (m) return new Date(m[1], m[2], m[3]);
            }
            return new Date(formatted || raw);
        }

        function formatGoogleTime(raw) {
            if (!raw || typeof raw !== 'string') return raw || "";
            if (raw.startsWith('Date(1899,11,30')) {
                const m = raw.match(/Date\(1899,11,30,(\d+),(\d+),(\d+)\)/);
                if (m) {
                    const h = m[1].padStart(2, '0');
                    const min = m[2].padStart(2, '0');
                    return `${h}:${min}`;
                }
            }
            return raw;
        }

        function getEventColor(type) {
            switch(type) {
                case 'ì£¼ì¼ì§‘íšŒ': return 'bg-blue-50 text-blue-700 border-blue-200';
                case 'ì†Œê·¸ë£¹': return 'bg-orange-50 text-orange-700 border-orange-200';
                case 'ì•„ì›ƒíŒ…': return 'bg-green-50 text-green-700 border-green-200';
                case 'íŠ¹ë³„ì§‘íšŒ': return 'bg-purple-50 text-purple-700 border-purple-200';
                case 'ì„ì„': return 'bg-pink-50 text-pink-700 border-pink-200';
                default: return 'bg-slate-50 text-slate-500 border-slate-200';
            }
        }

        function renderCalendar() {
            const y = currentDate.getFullYear(), m = currentDate.getMonth();
            document.getElementById('calendarTitle').innerHTML = `${y}ë…„ <span class="text-orange-500">${m+1}ì›”</span>`;
            
            const first = new Date(y, m, 1).getDay();
            const last = new Date(y, m+1, 0).getDate();
            const grid = document.getElementById('calendarGrid');
            grid.innerHTML = '';
            
            for(let i=0; i<first; i++) grid.innerHTML += '<div></div>';
            
            for(let i=1; i<=last; i++) {
                const targetDate = new Date(y, m, i);
                const isToday = (y === todayObj.getFullYear() && m === todayObj.getMonth() && i === todayObj.getDate());
                
                const dayEvents = events.filter(e => {
                    if(!e.start) return false;
                    const start = new Date(e.start); start.setHours(0,0,0,0);
                    const end = e.end ? new Date(e.end) : new Date(e.start); 
                    end.setHours(23,59,59,999);
                    return targetDate >= start && targetDate <= end;
                });

                let textClass = "text-slate-800";
                const dayOfWeek = targetDate.getDay();
                if (dayOfWeek === 0) textClass = "text-red-400";
                else if (dayOfWeek === 6) textClass = "text-blue-400";

                const eventHtml = dayEvents.map(e => {
                    const displayTitle = e.meetingType;
                    return `
                        <div class="event-bar border ${getEventColor(e.meetingType)}" onclick="event.stopPropagation(); openModal(${e.id})">
                            ${e.startTime ? `<span class="opacity-60 mr-0.5">${e.startTime}</span>` : ''}${displayTitle}
                        </div>
                    `;
                }).join('');

                grid.innerHTML += `
                    <div class="calendar-day" onclick="openDayInfo(${y}, ${m}, ${i})">
                        <div class="flex items-center justify-center w-6 h-6 md:w-9 md:h-9 ${isToday?'bg-orange-500 text-white rounded-full shadow-md':textClass} date-label mb-0.5 md:mb-1">
                            ${i}
                        </div>
                        <div class="w-full flex flex-col items-center overflow-hidden px-px">
                            ${eventHtml}
                        </div>
                    </div>`;
            }
        }

        window.openModal = (eventId) => {
            const e = events.find(item => item.id === eventId);
            if (!e) return;

            const sDate = new Date(e.start).toLocaleDateString('ko-KR', { month: 'long', day: 'numeric', weekday: 'short' });
            const eDate = e.end ? new Date(e.end).toLocaleDateString('ko-KR', { month: 'long', day: 'numeric', weekday: 'short' }) : sDate;
            const dateDisplay = (sDate === eDate) ? sDate : `${sDate} ~ ${eDate}`;
            const timeDisplay = (e.startTime || e.endTime) ? `${e.startTime || ''} ~ ${e.endTime || ''}` : "ì¢…ì¼ ì¼ì •";

            let detailHtml = '';

            if (e.meetingType === 'ì£¼ì¼ì§‘íšŒ') {
                detailHtml = `
                    <div class="bg-white border border-slate-100 rounded-2xl overflow-hidden shadow-sm">
                        <div class="bg-blue-50/50 px-4 py-2 border-b border-blue-100 text-[9px] md:text-[11px] font-black text-blue-400 uppercase tracking-widest text-center">ì£¼ì¼ ì§‘íšŒ ì •ë³´</div>
                        <div class="p-5 md:p-7 space-y-4 md:space-y-6">
                            <div class="flex justify-between items-center">
                                <span class="text-[11px] md:text-xs font-bold text-slate-400 uppercase tracking-tighter">ì§„í–‰ ë‹´ë‹¹</span>
                                <span class="text-sm md:text-base font-black text-slate-700">${e.leader}</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-[11px] md:text-xs font-bold text-slate-400 uppercase tracking-tighter">ë§ì”€ ë‹´ë‹¹</span>
                                <span class="text-sm md:text-base font-black text-slate-700">${e.speaker}</span>
                            </div>
                            <div class="flex justify-between items-center pt-3 md:pt-4 border-t border-slate-50">
                                <span class="text-[11px] md:text-xs font-bold text-slate-400 uppercase tracking-tighter">ë¶„ë°˜ ë‹´ë‹¹</span>
                                <span class="text-sm md:text-base font-black text-blue-600">${e.division}</span>
                            </div>
                        </div>
                    </div>
                `;
            } else if (e.meetingType === 'ì†Œê·¸ë£¹') {
                detailHtml = `
                    <div class="bg-white border border-slate-100 rounded-2xl overflow-hidden shadow-sm">
                        <div class="bg-orange-50/50 px-4 py-2 border-b border-orange-100 text-[9px] md:text-[11px] font-black text-orange-400 uppercase tracking-widest text-center">ì†Œê·¸ë£¹ ë° ì‹ì‚¬ ì•ˆë‚´</div>
                        <div class="p-5 md:p-7 space-y-4 md:space-y-6">
                            <div class="flex justify-between items-center">
                                <span class="text-[11px] md:text-xs font-bold text-slate-400 uppercase tracking-tighter">ì§„í–‰/ë´‰ì‚¬ë‹´ë‹¹</span>
                                <span class="text-sm md:text-base font-black text-slate-700">${e.leader}</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-[11px] md:text-xs font-bold text-slate-400 uppercase tracking-tighter">ì‹ì‚¬ì¤€ë¹„ / íŒ€</span>
                                <span class="text-sm md:text-base font-black text-slate-700">${e.mealPrep} <span class="text-slate-300 font-normal">|</span> ${e.mealTeam}</span>
                            </div>
                            <div class="pt-4 md:pt-6 border-t border-slate-50 text-center">
                                <div class="text-[9px] md:text-[11px] font-bold text-orange-400 mb-1 flex items-center justify-center gap-1">ğŸ½ï¸ ì˜¤ëŠ˜ì˜ ë©”ë‰´</div>
                                <div class="text-lg md:text-2xl font-black text-slate-800 leading-tight">${e.menu}</div>
                            </div>
                            <div class="flex justify-between items-center pt-3 md:pt-4 border-t border-slate-50">
                                <span class="text-[11px] md:text-xs font-bold text-slate-400 uppercase tracking-tighter">ì„¤ê±°ì§€ ë´‰ì‚¬</span>
                                <span class="text-sm md:text-base font-bold text-slate-600">${e.wash}</span>
                            </div>
                        </div>
                    </div>
                `;
            } else {
                detailHtml = `
                    <div class="bg-slate-50 p-5 md:p-8 rounded-2xl border border-slate-100 shadow-sm">
                        <div class="text-[9px] md:text-[11px] font-bold text-slate-400 mb-3 uppercase tracking-widest text-center border-b border-slate-200 pb-2">ìƒì„¸ ë‚´ì—­</div>
                        <div class="text-sm md:text-base text-slate-700 leading-relaxed font-medium whitespace-pre-wrap keep-all">
                            ${e.note || "ë“±ë¡ëœ ìƒì„¸ ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤."}
                        </div>
                    </div>
                `;
            }

            const mainTitle = e.subject || e.meetingType;

            document.getElementById('modalContent').innerHTML = `
                <div class="text-center mb-6 md:mb-10">
                    <div class="inline-block px-5 md:px-8 py-2 md:py-3 ${getEventColor(e.meetingType)} rounded-full text-base md:text-2xl font-black uppercase tracking-widest border-2 shadow-sm mb-3 leading-tight">
                        ${e.meetingType}
                    </div>
                    ${e.subject ? `
                        <div class="text-slate-500 font-bold text-sm md:text-lg mt-1 italic tracking-tight opacity-80 keep-all">
                            ${e.subject}
                        </div>
                    ` : ''}
                </div>
                
                <div class="space-y-4 md:space-y-6">
                    <div class="grid grid-cols-2 gap-2 md:gap-4">
                        <div class="bg-slate-50 p-3 md:p-5 rounded-xl border border-slate-100 shadow-sm">
                            <div class="text-[9px] md:text-[11px] font-bold text-slate-400 mb-1 uppercase tracking-tighter">ì¼ì‹œ</div>
                            <div class="text-[11px] md:text-sm font-bold text-slate-700">${dateDisplay}</div>
                        </div>
                        <div class="bg-slate-50 p-3 md:p-5 rounded-xl border border-slate-100 shadow-sm">
                            <div class="text-[9px] md:text-[11px] font-bold text-slate-400 mb-1 uppercase tracking-tighter">ì‹œê°„</div>
                            <div class="text-[11px] md:text-sm font-bold text-orange-500">${timeDisplay}</div>
                        </div>
                    </div>

                    ${detailHtml}

                    ${e.note && (e.meetingType === 'ì£¼ì¼ì§‘íšŒ' || e.meetingType === 'ì†Œê·¸ë£¹') ? `
                    <div class="bg-orange-50/30 p-4 md:p-6 rounded-xl border border-orange-100 border-dashed">
                        <div class="text-[9px] md:text-[11px] font-bold text-orange-400 mb-1 uppercase tracking-tighter">ë¹„ê³  ì‚¬í•­</div>
                        <div class="text-[11px] md:text-sm text-slate-600 leading-relaxed whitespace-pre-wrap keep-all">${e.note}</div>
                    </div>` : ''}
                </div>
            `;
            document.getElementById('detailModal').classList.remove('hidden');
            document.body.style.overflow = 'hidden';
        };

        window.openDayInfo = (y, m, d) => {
            const target = new Date(y, m, d);
            const dayEvents = events.filter(e => {
                const start = new Date(e.start); start.setHours(0,0,0,0);
                const end = e.end ? new Date(e.end) : new Date(e.start); 
                end.setHours(23,59,59,999);
                return target >= start && target <= end;
            });
            if (dayEvents.length > 0) openModal(dayEvents[0].id);
        };

        window.closeModal = () => {
            document.getElementById('detailModal').classList.add('hidden');
            document.body.style.overflow = 'auto';
        };

        document.getElementById('prevMonth').onclick = () => { currentDate.setMonth(currentDate.getMonth() - 1); renderCalendar(); };
        document.getElementById('nextMonth').onclick = () => { currentDate.setMonth(currentDate.getMonth() + 1); renderCalendar(); };
        window.goToToday = () => { currentDate = new Date(todayObj.getFullYear(), todayObj.getMonth(), 1); renderCalendar(); };

        fetchGoogleSheetData();
    </script>
</body>
</html>
