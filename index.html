<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì•ˆì–‘êµíšŒ ìœ ì´ˆë“±ë¶€ ì¼ì • ì•ˆë‚´</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700;900&display=swap" rel="stylesheet">
    <style>
        :root {
            /* ì‚¬ì´ì¦ˆ ì¡°ì ˆ ë³€ìˆ˜ */
            --day-min-height-mobile: 95px;
            --day-min-height-tablet: 110px;
            --day-min-height-pc: 160px;
            --date-font-size: 0.95rem; 
            --event-font-size: 10px; 
            --event-font-size-pc: 12px;
        }

        body { 
            font-family: 'Noto Sans KR', sans-serif; 
            background-color: #fdfcf8; 
            scroll-behavior: smooth;
            font-size: 14px;
            transition: font-size 0.2s ease;
        }
        @media (min-width: 768px) {
            body { font-size: 16px; }
        }
        
        .calendar-day { 
            min-height: var(--day-min-height-tablet); 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            justify-content: flex-start; 
            padding: 0.2rem 0.05rem; 
            border-radius: 0.5rem; 
            position: relative; 
            transition: all 0.2s ease-in-out; 
            border: 1px solid #f1f5f9; 
            background: white; 
            overflow: hidden; 
        }

        @media (max-width: 767px) {
            .calendar-day { 
                min-height: var(--day-min-height-mobile); 
                padding: 0.15rem 0.02rem;
                border-radius: 0.3rem;
            }
        }

        @media (min-width: 1024px) { 
            .calendar-day { 
                min-height: var(--day-min-height-pc); 
                padding: 0.5rem 0.15rem; 
                border-radius: 1rem; 
            } 
        }

        .calendar-day:hover { 
            background-color: #fffaf5; 
            z-index: 10; 
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08); 
            transform: translateY(-2px);
        }

        .event-container {
            width: 100%;
            flex: 1;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            align-items: center;
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        .event-container::-webkit-scrollbar {
            display: none;
        }

        .date-label {
            font-size: var(--date-font-size);
            font-weight: 900;
            flex-shrink: 0;
        }
        
        .event-bar { 
            font-size: var(--event-font-size); 
            padding: 2px 2px; 
            border-radius: 4px; 
            margin-top: 2px; 
            width: 98%; 
            white-space: nowrap;
            overflow: hidden;
            text-overflow: clip;
            font-weight: 700; 
            cursor: pointer; 
            text-align: center; 
            border-width: 1.5px;
            line-height: 1.1;
            flex-shrink: 0;
            letter-spacing: -0.04em; 
        }

        @media (min-width: 768px) { 
            .event-bar { 
                font-size: var(--event-font-size-pc); 
                padding: 4px 4px; 
                border-radius: 6px; 
                margin-top: 3px;
                border-width: 2px;
                letter-spacing: -0.02em;
            } 
        }
        
        .loader { border: 3px solid #f3f3f3; border-top: 3px solid #fb923c; border-radius: 50%; width: 28px; height: 28px; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        
        .section-card { background: white; border-radius: 1.5rem; box-shadow: 0 10px 40px -10px rgba(0,0,0,0.06); border: 1px solid #f1f5f9; overflow: hidden; }
        @media (min-width: 768px) {
            .section-card { border-radius: 3rem; }
        }

        .kids-gradient { background: linear-gradient(135deg, #fb923c 0%, #facc15 100%); }
        .keep-all { word-break: keep-all; }
    </style>
</head>
<body class="text-slate-800">

    <!-- ë¡œë”© í™”ë©´ -->
    <div id="loadingOverlay" class="fixed inset-0 bg-white/95 backdrop-blur-md z-50 flex flex-col items-center justify-center transition-opacity duration-500">
        <div class="loader mb-4" id="mainLoader"></div>
        <p class="text-orange-600 font-bold tracking-tight text-sm md:text-base" id="loadingStatus">ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤...</p>
        <button onclick="hideLoader()" id="forceCloseBtn" class="hidden mt-8 text-xs text-slate-400 underline">ìˆ˜ë™ìœ¼ë¡œ ë‹«ê¸°</button>
    </div>

    <!-- ë„¤ë¹„ê²Œì´ì…˜ -->
    <nav class="sticky top-0 z-40 bg-white/90 backdrop-blur-md border-b border-orange-100 px-2 md:px-0">
        <div class="max-w-6xl mx-auto px-2 md:px-6 h-14 md:h-16 flex items-center justify-between">
            <div class="flex items-center gap-2 md:gap-3">
                <div class="w-7 h-7 md:w-8 md:h-8 kids-gradient rounded-lg flex items-center justify-center text-white font-black shadow-sm text-xs md:text-base">ê¿ˆ</div>
                <span class="font-black text-sm md:text-xl tracking-tight text-slate-800">ì•ˆì–‘êµíšŒ ìœ ì´ˆë“±ë¶€</span>
            </div>
            
            <button onclick="openInstallModal()" class="flex items-center gap-1.5 bg-orange-50 text-orange-500 px-3 py-1.5 rounded-full border border-orange-100 hover:bg-orange-100 transition-colors shadow-sm">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2z"></path></svg>
                <span class="text-[10px] md:text-xs font-bold">í™ˆí™”ë©´ ì¶”ê°€</span>
            </button>
        </div>
    </nav>

    <header class="max-w-6xl mx-auto px-4 md:px-6 pt-4 md:pt-10 pb-2 md:pb-6 text-center">
        <h1 class="text-xl md:text-5xl font-black text-slate-900 mb-1 md:mb-3 leading-tight keep-all">
            ìš°ë¦¬ë“¤ì˜ <span class="text-orange-500">ì¦ê±°ìš´ ì•½ì†</span>
        </h1>
    </header>

    <main class="max-w-[99%] mx-auto pb-16">
        <section id="schedule" class="mt-1 md:mt-4">
            <div class="section-card p-1 md:p-8 lg:p-10">
                <div class="flex justify-between items-center mb-3 md:mb-8 px-1">
                    <button id="prevMonth" class="p-2 md:p-4 text-slate-400 hover:text-orange-500 rounded-full hover:bg-orange-50 active:scale-90 transition-all">
                        <svg class="w-6 h-6 md:w-8 md:h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M15 19l-7-7 7-7"></path></svg>
                    </button>
                    
                    <div class="flex flex-col items-center">
                        <div class="flex items-center gap-2 md:gap-6">
                            <h3 id="calendarTitle" class="text-xl md:text-4xl font-black text-slate-800 tracking-tighter">ë¡œë”©ì¤‘...</h3>
                            <button onclick="goToToday()" class="text-[10px] md:text-xs font-black text-orange-600 bg-orange-50 hover:bg-orange-100 border border-orange-200 px-3 md:px-5 py-1.5 rounded-full shadow-sm">Today</button>
                        </div>
                    </div>

                    <button id="nextMonth" class="p-2 md:p-4 text-slate-400 hover:text-orange-500 rounded-full hover:bg-orange-50 active:scale-90 transition-all">
                        <svg class="w-6 h-6 md:w-8 md:h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M9 5l7 7-7 7"></path></svg>
                    </button>
                </div>

                <div class="grid grid-cols-7 gap-1 text-center mb-1 md:mb-4 border-b border-slate-50 pb-2">
                    <div class="text-red-400 font-black text-[10px] md:text-sm uppercase">Sun</div>
                    <div class="text-slate-300 font-black text-[10px] md:text-sm uppercase">Mon</div>
                    <div class="text-slate-300 font-black text-[10px] md:text-sm uppercase">Tue</div>
                    <div class="text-slate-300 font-black text-[10px] md:text-sm uppercase">Wed</div>
                    <div class="text-slate-300 font-black text-[10px] md:text-sm uppercase">Thu</div>
                    <div class="text-slate-300 font-black text-[10px] md:text-sm uppercase">Fri</div>
                    <div class="text-blue-400 font-black text-[10px] md:text-sm uppercase">Sat</div>
                </div>

                <div id="calendarGrid" class="grid grid-cols-7 gap-px sm:gap-1 md:gap-2 text-center"></div>
            </div>
        </section>
    </main>

    <footer class="py-12 text-center text-slate-300 text-[10px] md:text-xs font-medium tracking-[0.2em] uppercase px-4 keep-all">
        Â© 2026 ANYANG CHURCH CHILDREN MINISTRY.
    </footer>

    <!-- ìƒì„¸ ì¼ì • ëª¨ë‹¬ -->
    <div id="detailModal" class="hidden fixed inset-0 z-50 overflow-y-auto">
        <div class="fixed inset-0 bg-slate-900/70 backdrop-blur-md transition-opacity" onclick="closeModal()"></div>
        <div class="flex min-h-full items-center justify-center p-4">
            <div class="bg-white rounded-[2rem] shadow-2xl w-full max-w-lg relative overflow-hidden transform transition-all animate-in zoom-in duration-200">
                <button onclick="closeModal()" class="absolute top-5 right-5 text-slate-400 hover:text-slate-800 bg-slate-100 rounded-full p-2 md:p-3 transition-colors z-10">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M6 18L18 6M6 6l12 12"></path></svg>
                </button>
                <div id="modalContent" class="max-h-[85vh] overflow-y-auto p-8 md:p-12"></div>
            </div>
        </div>
    </div>

    <!-- í™ˆí™”ë©´ ì¶”ê°€ ì•ˆë‚´ ëª¨ë‹¬ -->
    <div id="installModal" class="hidden fixed inset-0 z-[60] overflow-y-auto">
        <div class="fixed inset-0 bg-orange-900/40 backdrop-blur-sm transition-opacity" onclick="closeInstallModal()"></div>
        <div class="flex min-h-full items-center justify-center p-4">
            <div class="bg-white rounded-[2.5rem] shadow-2xl w-full max-w-md relative overflow-hidden transform transition-all p-8 md:p-10">
                <button onclick="closeInstallModal()" class="absolute top-5 right-5 text-slate-300 hover:text-slate-800 bg-slate-100 rounded-full p-2.5 transition-colors">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M6 18L18 6M6 6l12 12"></path></svg>
                </button>
                <div class="text-center mb-8">
                    <div class="w-16 h-16 kids-gradient rounded-2xl flex items-center justify-center text-white text-3xl font-black shadow-lg mx-auto mb-4">ê¿ˆ</div>
                    <h3 class="text-xl md:text-2xl font-black text-slate-800 tracking-tight">í™ˆ í™”ë©´ì— ì¶”ê°€í•˜ê¸°</h3>
                </div>
                <div class="space-y-6">
                    <div class="bg-slate-50 p-5 rounded-2xl border border-slate-100">
                        <div class="flex items-center gap-3 mb-3"><span class="bg-blue-500 text-white w-5 h-5 rounded-full flex items-center justify-center text-[10px] font-bold">1</span><span class="font-bold text-slate-700">ì•„ì´í° (Safari)</span></div>
                        <p class="text-xs text-slate-500 leading-relaxed pl-8">í•˜ë‹¨ ì¤‘ì•™ì˜ 'ê³µìœ  ë²„íŠ¼(â–¡â†‘)' í´ë¦­ í›„ 'í™ˆ í™”ë©´ì— ì¶”ê°€'ë¥¼ ì„ íƒí•˜ì„¸ìš”.</p>
                    </div>
                    <div class="bg-slate-50 p-5 rounded-2xl border border-slate-100">
                        <div class="flex items-center gap-3 mb-3"><span class="bg-green-500 text-white w-5 h-5 rounded-full flex items-center justify-center text-[10px] font-bold">2</span><span class="font-bold text-slate-700">ì•ˆë“œë¡œì´ë“œ (Chrome)</span></div>
                        <p class="text-xs text-slate-500 leading-relaxed pl-8">ìš°ì¸¡ ìƒë‹¨ 'ì  ì„¸ê°œ(â‹®)' í´ë¦­ í›„ 'í™ˆ í™”ë©´ì— ì¶”ê°€'ë¥¼ ì„ íƒí•˜ì„¸ìš”.</p>
                    </div>
                </div>
                <!-- ë²„íŠ¼ ìƒ‰ìƒì„ ê²€ì€ìƒ‰(slate-900)ìœ¼ë¡œ ë³€ê²½í•˜ì—¬ ì‹œì¸ì„± í™•ë³´ -->
                <button onclick="closeInstallModal()" class="w-full mt-8 bg-slate-900 text-white font-black py-4 rounded-2xl shadow-xl hover:bg-black transition-all">ë‹«ê¸°</button>
            </div>
        </div>
    </div>

    <script>
        const SHEET_ID = '18zGuXQQWPm_dM2W6xD2Ugysaiz-sukIFJByO_TZrFy0'; 
        let events = []; 
        const todayObj = new Date();
        let currentDate = new Date(todayObj.getFullYear(), todayObj.getMonth(), 1); 

        window.hideLoader = () => {
            document.getElementById('loadingOverlay').classList.add('opacity-0');
            setTimeout(() => document.getElementById('loadingOverlay').classList.add('hidden'), 500);
        };

        window.openInstallModal = () => { document.getElementById('installModal').classList.remove('hidden'); document.body.style.overflow = 'hidden'; };
        window.closeInstallModal = () => { document.getElementById('installModal').classList.add('hidden'); document.body.style.overflow = 'auto'; };

        async function fetchGoogleSheetData() {
            try {
                const url = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json&t=${Date.now()}`;
                const res = await fetch(url);
                if (!res.ok) throw new Error("ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜");
                const text = await res.text();
                const startIdx = text.indexOf('{');
                const endIdx = text.lastIndexOf('}') + 1;
                const jsonText = text.substring(startIdx, endIdx);
                const json = JSON.parse(jsonText);
                const rows = json.table.rows;
                
                events = rows.map((r, idx) => {
                    const rowData = r.c;
                    if (!rowData || !rowData[0] || rowData[0].f === "ì‹œì‘ì¼") return null; 
                    return {
                        id: idx,
                        start: parseGoogleDate(rowData[0]?.v, rowData[0]?.f),
                        end: parseGoogleDate(rowData[1]?.v, rowData[1]?.f),
                        startTime: formatGoogleTime(rowData[2]?.v),
                        endTime: formatGoogleTime(rowData[3]?.v),
                        meetingType: rowData[4]?.v || "ì†Œê·¸ë£¹",
                        leader: rowData[5]?.v || "-",
                        speaker: rowData[6]?.v || "-",
                        division: rowData[7]?.v || "-",
                        mealPrep: rowData[8]?.v || "-",
                        mealTeam: rowData[9]?.v || "-",
                        menu: rowData[10]?.v || "-",
                        wash: rowData[11]?.v || "-",
                        subject: rowData[12]?.v || "",
                        note: rowData[13]?.v || ""
                    };
                }).filter(e => e !== null);
                hideLoader();
            } catch (e) { 
                console.error(e);
                document.getElementById('loadingStatus').innerText = "ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨";
                document.getElementById('forceCloseBtn').classList.remove('hidden');
                document.getElementById('mainLoader').classList.add('hidden');
            }
            renderCalendar();
        }

        function parseGoogleDate(raw, formatted) {
            if (!raw) return null;
            if (typeof raw === 'string' && raw.startsWith('Date')) {
                const m = raw.match(/Date\((\d+),(\d+),(\d+)\)/);
                if (m) return new Date(m[1], m[2], m[3]);
            }
            return new Date(formatted || raw);
        }

        function formatGoogleTime(raw) {
            if (!raw || typeof raw !== 'string') return raw || "";
            if (raw.startsWith('Date(1899,11,30')) {
                const m = raw.match(/Date\(1899,11,30,(\d+),(\d+),(\d+)\)/);
                if (m) return `${m[1].padStart(2, '0')}:${m[2].padStart(2, '0')}`;
            }
            return raw;
        }

        function getEventColor(type) {
            switch(type) {
                case 'ì£¼ì¼ì§‘íšŒ': return 'bg-blue-50 text-blue-700 border-blue-200';
                case 'ì†Œê·¸ë£¹': return 'bg-orange-50 text-orange-700 border-orange-200';
                case 'ì•„ì›ƒíŒ…': return 'bg-green-50 text-green-700 border-green-200';
                case 'íŠ¹ë³„ì§‘íšŒ': return 'bg-purple-50 text-purple-700 border-purple-200';
                case 'ì„ì„': return 'bg-pink-50 text-pink-700 border-pink-200';
                default: return 'bg-slate-50 text-slate-500 border-slate-200';
            }
        }

        function renderCalendar() {
            const y = currentDate.getFullYear(), m = currentDate.getMonth();
            document.getElementById('calendarTitle').innerHTML = `${y}ë…„ <span class="text-orange-500">${m+1}ì›”</span>`;
            const firstDay = new Date(y, m, 1).getDay();
            const daysInMonth = new Date(y, m+1, 0).getDate();
            const grid = document.getElementById('calendarGrid');
            grid.innerHTML = '';
            for(let i=0; i<firstDay; i++) grid.innerHTML += '<div></div>';
            for(let i=1; i<=daysInMonth; i++) {
                const targetDate = new Date(y, m, i);
                const isToday = (y === todayObj.getFullYear() && m === todayObj.getMonth() && i === todayObj.getDate());
                const dayEvents = events.filter(e => {
                    if(!e.start) return false;
                    const s = new Date(e.start); s.setHours(0,0,0,0);
                    const end = e.end ? new Date(e.end) : new Date(e.start); 
                    end.setHours(23,59,59,999);
                    return targetDate >= s && targetDate <= end;
                });
                const eventHtml = dayEvents.map(e => `<div class="event-bar border ${getEventColor(e.meetingType)}" onclick="event.stopPropagation(); openSingleEventModal(${e.id})">${e.meetingType}</div>`).join('');
                grid.innerHTML += `<div class="calendar-day" onclick="openDayInfo(${y}, ${m}, ${i})"><div class="date-label ${isToday?'bg-orange-500 text-white rounded-full w-6 h-6 md:w-10 md:h-10 flex items-center justify-center shadow-md':'w-6 h-6 md:w-10 md:h-10 flex items-center justify-center '+(targetDate.getDay()===0?'text-red-500':targetDate.getDay()===6?'text-blue-500':'text-slate-800')} mb-1">${i}</div><div class="event-container">${eventHtml}</div></div>`;
            }
        }

        window.openDayInfo = (y, m, d) => {
            const target = new Date(y, m, d);
            const dayEvents = events.filter(e => {
                const s = new Date(e.start); s.setHours(0,0,0,0);
                const end = e.end ? new Date(e.end) : new Date(e.start); 
                end.setHours(23,59,59,999);
                return target >= s && target <= end;
            });
            if (dayEvents.length > 0) renderMultipleEventsModal(dayEvents, target);
        };

        window.openSingleEventModal = (eventId) => {
            const e = events.find(item => item.id === eventId);
            if (e) renderMultipleEventsModal([e], new Date(e.start));
        };

        function renderMultipleEventsModal(dayEvents, date) {
            const dayName = ['ì¼', 'ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ', 'í† '][date.getDay()];
            const dateStr = `${date.getMonth() + 1}ì›” ${date.getDate()}ì¼ (${dayName})`;
            let html = `<div class="text-center mb-8 border-b border-slate-100 pb-4"><h2 class="text-2xl md:text-3xl font-black text-slate-800">${dateStr}</h2></div><div class="space-y-10">`;
            dayEvents.forEach((e, idx) => {
                const timeDisplay = (e.startTime || e.endTime) ? `${e.startTime || ''} ~ ${e.endTime || ''}` : "ì¢…ì¼ ì¼ì •";
                let detailHtml = '';
                if (e.meetingType === 'ì£¼ì¼ì§‘íšŒ') {
                    detailHtml = `<div class="bg-white border border-slate-100 rounded-2xl overflow-hidden shadow-sm"><div class="bg-blue-50/50 px-4 py-2 border-b border-blue-100 text-[9px] md:text-[11px] font-black text-blue-400 uppercase tracking-widest text-center">ì£¼ì¼ ì§‘íšŒ ì •ë³´</div><div class="p-5 md:p-7 space-y-4 md:space-y-5"><div class="flex justify-between items-center"><span>ì§„í–‰</span><span class="font-black">${e.leader}</span></div><div class="flex justify-between items-center"><span>ë§ì”€</span><span class="font-black">${e.speaker}</span></div><div class="flex justify-between items-center pt-3 border-t"><span>ë¶„ë°˜</span><span class="font-black text-blue-600">${e.division}</span></div></div></div>`;
                } else if (e.meetingType === 'ì†Œê·¸ë£¹') {
                    detailHtml = `<div class="bg-white border border-slate-100 rounded-2xl overflow-hidden shadow-sm"><div class="bg-orange-50/50 px-4 py-2 border-b border-orange-100 text-[9px] md:text-[11px] font-black text-orange-400 uppercase tracking-widest text-center">ì†Œê·¸ë£¹ ë° ì‹ì‚¬ ì•ˆë‚´</div><div class="p-5 md:p-7 space-y-4 md:space-y-5"><div class="flex justify-between items-center"><span>ë‹´ë‹¹</span><span class="font-black">${e.leader}</span></div><div class="flex justify-between items-center"><span>ì‹ì‚¬íŒ€</span><span class="font-black">${e.mealPrep} | ${e.mealTeam}</span></div><div class="pt-4 border-t text-center"><div class="text-[9px] font-bold text-orange-400 mb-1">ğŸ½ï¸ ì˜¤ëŠ˜ì˜ ë©”ë‰´</div><div class="text-lg md:text-2xl font-black text-slate-800 leading-tight text-center">${e.menu}</div></div><div class="flex justify-between items-center pt-3 border-t"><span>ì„¤ê±°ì§€</span><span class="font-bold">${e.wash}</span></div></div></div>`;
                } else {
                    detailHtml = `<div class="bg-slate-50 p-5 md:p-8 rounded-2xl border border-slate-100 shadow-sm"><div class="text-[9px] font-bold text-slate-400 mb-3 uppercase tracking-widest text-center border-b pb-2 text-center">ìƒì„¸ ë‚´ì—­</div><div class="text-sm md:text-base text-slate-700 leading-relaxed font-medium whitespace-pre-wrap text-center">${e.note || "ìƒì„¸ ë‚´ì—­ ì—†ìŒ"}</div></div>`;
                }
                html += `<div class="${idx !== dayEvents.length - 1 ? 'border-b-2 border-dashed border-slate-100 pb-10' : ''}"><div class="text-center mb-6"><div class="inline-block px-5 md:px-8 py-2 md:py-3 ${getEventColor(e.meetingType)} rounded-full text-base md:text-2xl font-black uppercase tracking-widest border-2 shadow-sm mb-2 leading-tight">${e.meetingType}</div>${e.subject ? `<div class="text-slate-500 font-bold text-sm md:text-lg mt-1 italic tracking-tight opacity-80">${e.subject}</div>` : ''}</div><div class="space-y-4"><div class="bg-slate-50 p-3 md:p-5 rounded-xl flex justify-between items-center"><span>ì‹œê°„</span><span class="font-bold text-orange-500">${timeDisplay}</span></div>${detailHtml}${e.note && (e.meetingType === 'ì£¼ì¼ì§‘íšŒ' || e.meetingType === 'ì†Œê·¸ë£¹') ? `<div class="bg-orange-50/30 p-4 md:p-6 rounded-xl border border-orange-100 border-dashed"><div class="text-[10px] font-bold text-orange-400 mb-1 uppercase">ë¹„ê³ </div><div class="text-[11px] md:text-sm text-slate-600 leading-relaxed whitespace-pre-wrap keep-all">${e.note}</div></div>` : ''}</div></div>`;
            });
            html += `</div>`;
            document.getElementById('modalContent').innerHTML = html;
            document.getElementById('detailModal').classList.remove('hidden');
            document.body.style.overflow = 'hidden';
        }

        window.closeModal = () => { document.getElementById('detailModal').classList.add('hidden'); document.body.style.overflow = 'auto'; };
        document.getElementById('prevMonth').onclick = () => { currentDate.setMonth(currentDate.getMonth() - 1); renderCalendar(); };
        document.getElementById('nextMonth').onclick = () => { currentDate.setMonth(currentDate.getMonth() + 1); renderCalendar(); };
        window.goToToday = () => { currentDate = new Date(todayObj.getFullYear(), todayObj.getMonth(), 1); renderCalendar(); };
        fetchGoogleSheetData();
    </script>
</body>
</html>
